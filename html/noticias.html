<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" type="text/css" href="../css/noticias.css" /> 
  <title>Arena 360 ‚Äî Not√≠cias</title>
</head>
<body>

  <!-- Bot√£o do menu -->
  <button id="toggle-menu" class="menu-btn">‚ò∞</button> <!--BOT√ÉO QUE REPRESENTA O SIMBOLO DO 'BURGER MENU', QUE EST√Å PROGRAMADO PARA ABRIR E FECHAR A SIDEBAR, BEM COMO SURGIR APENAS EM RESOLU√á√ïES MOBILE E TABLET-->

  <!-- Sidebar -->
  <!--A DIV ABAIXO REPRESENTA A SIDEBAR (MENU LATERAL), QUE ESTAR√Å VISIVEL EM RESOLU√á√ïES DESKTOP e 'FECHADA' (COM A POSSIBILIDADE DE SER EXPANDIDA) EM RESOLU√á√ïES MOBILE/TABLET-->

  <div class="sidebar" id="sidebar">
      
      <!--A SIDEBAR COME√áA SEMPRE COM O LOGOTIPO DE SIDEBAR DA PLATAFORMA 'ARENA 360'-->
      <a href="../html/homepage.html"> <!--O LOGOTIPO √â CLIC√ÅVEL. AO CLICAR NESSE LOGOTIPO, O UTILIZADOR √â REDIRECIONADO PARA A P√ÅGINA REFERIDA NO 'a href', que neste caso ser√° a HOMEPAGE da plataforma.-->
        <img src="../icons/image-removebg-preview (11).png" style="margin-left: 6%; list-style-type: none;">
      </a>
      
      <!--O DIV 'DIVIDER' representa apenas a estiliza√ß√£o do 'separador' vermelho encontrado logo abaixo do logotipo da sidebar-->
      <div class="divider"></div>


      <!--No Menu Lateral teremos 3 sec√ß√µes, cada uma delas representando uma modalidade. Cada sec√ß√£o ter√° v√°rias op√ß√µes de navega√ß√£o. Tudo isto encapsulado permitiu criar um menu lateral organizado e consistente.-->
      <ul class="menu" style="list-style-type: none;">
        <!--As modalidades s√£o no fundo, sec√ß√µes de items de uma lista de um menu, e onde, dentro de cada elemento da lista 'MENU', temos mais elementos destinados √†s op√ß√µes de navega√ß√£o de cada item-parent, que √© a respetiva modalidade.-->
        <li><img src="../icons/2560px-UFC_Logo.svg.png" class="icon"><strong></strong>
          <ul>
            
            <!--Cada modalidade no menu lateral, tem 4 op√ß√µes: Reservar Bilhetes para a modalidade, obter lutadores/atletas da modalidade, resultados de ultimos eventos e Noticias relacionadas com a mesma.-->

            <!--As p√°ginas de RESERVA DE BILHETES e de LUTADORES/ATLETAS, al√©m de alterarem o seu conteudo, tamb√©m alteram a sua estiliza√ß√£o conforme a modalidade respetiva, da√≠ a utiliza√ß√£o das fun√ß√µes 'selecionarModalidade()' e 'definirModalidade()', passando uma string com o nome da modalidade que ser√° associada √†s suas respetivas estiliza√ß√µes.-->
            <li><a href="../html/reservabilhetesteste.html" onclick="selecionarModalidade('UFC')">Reservar Bilhetes</a></li>
            <li><a href="../html/lutadoresatletasdefteste.html" onclick="definirModalidade('UFC')">Lutadores</a></li>
            <li><a href="../html/resultadosteste.html">Resultados</a></li>
            <li><a href="../html/noticias.html">Not√≠cias</a></li>
          </ul>
        </li>
        <li><img src="../icons/WWE_Logo.svg.png" class="icon"><strong></strong>
          <ul>
            <li><a href="../html/reservabilhetesteste.html" onclick="selecionarModalidade('WWE')">Reservar Bilhetes</a></li>
            <li><a href="../html/lutadoresatletasdefteste.html" onclick="definirModalidade('WWE')">Lutadores</a></li>
            <li><a href="../html/resultadosteste.html">Resultados</a></li>
            <li><a href="../html/noticias.html">Not√≠cias</a></li>
          </ul>
        </li>
        <li><img src="../icons/Professional_Bull_Riders_logo.png" class="icon"><strong></strong>
          <ul>
            <li><a href="../html/reservabilhetesteste.html" onclick="selecionarModalidade('PBR')">Reservar Bilhetes</a></li>
            <li><a href="../html/lutadoresatletasdefteste.html" onclick="definirModalidade('PBR')">Atletas</a></li>
            <li><a href="../html/resultadosteste.html">Resultados</a></li>
            <li><a href="../html/noticias.html">Not√≠cias</a></li>
          </ul>
        </li>
        <li><strong>Lojas Oficiais</strong>
        
          <ul>
            <li><a href="../html/testesotres.html">Lojas</a></li>
          </ul>
        </li>
      </ul>
    </div>



  <!--DIV QUE VAI ARMAZENAR OP√á√ÉO DE FILTRAGEM DE NOTICIAS POR MODALIDADE-->

  <div class="filtro-modalidade">
    
    <label for="seletor-modalidade">Seleciona a modalidade:</label> <!--INDICA√á√ÉO DA ZONA DE FILTRAGEM-->
    <select id="seletor-modalidade"> <!--PARA LISTAR AS OP√á√ïES (ESTRUTURALMENTE FALANDO), USAREMOS UM SELECT COM V√ÅRIAS OPTIONS, CADA UMA CORRESPONDENTE A UMA MODALIDADE-->
      <option value="UFC">UFC</option>  
      <option value="WWE">WWE</option>
      <option value="PBR">PBR</option>
    </select>
  </div>
  

  <!-- Conte√∫do Principal (onde ser√£o listadas as noticias) -->
  <main class="noticias-container">
    <h1>Not√≠cias Recentes</h1>
    <p class="sub">As √∫ltimas novidades sobre UFC, WWE e PBR</p>
   <div class="noticias-wrapper">
    <div id="noticias-lista" class="noticias-lista">
      <!-- Aqui ser√£o carregadas as not√≠cias via JS (api de noticias) -->
    </div>
   </div>
  </main>


  <!--Usaremos esta div para iniciar o sistema de pagina√ß√£o de artigos de noticias-->
  <div class="paginacao">
    <button id="anterior">Anterior</button> <!--Ser√° um bot√£o usado para regredir na pagina√ß√£o-->
    <span id="pagina-atual">1</span> <!--Contador que exibe a p√°gina atual de noticias-->
    <button id="proximo">Pr√≥xima</button> <!--Ser√° um bot√£o usado para avan√ßar para a pr√≥xima p√°gina-->
  </div>
  


  <!--Popup que surge quando um artigo de noticia √© selecionado. Exibe mais algumas infos da noticia como titulo, descri√ß√£o, e um bot√£o para ler a noticia completa que, via JS, redirecionar√° o utilizador para a respetiva noticia.-->
  <div id="modal-noticia" class="modal hidden">
    <div class="modal-content">
      <span class="fechar-modal" onclick="fecharModal()">√ó</span> <!--FECHAR O POPUP-->
      <img id="modal-img" src="" alt="" class="modal-img">
      <h2 id="modal-titulo"></h2>
      <p id="modal-desc"></p>
      <a id="modal-link" href="#" target="_blank" class="ler-mais">Ler not√≠cia completa</a>
    </div>
  </div>
  

  <!-- ESTRUTURA DO FOOTER -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-section">
        <h3>Arena 360</h3>
        <p>&copy; 2025 ‚Äî Todos os direitos reservados.</p>
      </div>
      <div class="footer-section">
        <h4>Links</h4>
        <ul>
          <li><a href="#">Pol√≠tica de Privacidade</a></li>
          <li><a href="#">Termos de Uso</a></li>
          <li><a href="#">FAQ</a></li>
          <li><a href="#">Suporte</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Contactos</h4>
        <p>üìß suporte@arena360.com</p>
        <p>üìû +351 912 345 678</p>
      </div>
      <div class="footer-section">
        <h4>Segue-nos</h4>
        <div class="social-icons">
          <a href="#"><img src="../icons/instagram-new--v2.png" alt="Instagram"></a>
          <a href="#"><img src="../icons/twitterx--v2.png" alt="Twitter"></a>
          <a href="#"><img src="../icons/youtube-play.png" alt="YouTube"></a>
        </div>
      </div>
    </div>
  </footer>

  <script>
    const toggleBtn = document.getElementById('toggle-menu'); // Refer√™ncia ao bot√£o de abrir/fechar o menu (‚ò∞)
    const sidebar = document.getElementById('sidebar'); // Refer√™ncia √† sidebar

    // Alternar visibilidade da sidebar ao clicar no bot√£o
    toggleBtn.addEventListener('click', () => {
      sidebar.classList.toggle('active');
    });

    // Fechar sidebar ao clicar em qualquer link do menu (em dispositivos m√≥veis/tablets)
    document.querySelectorAll('.sidebar a').forEach(link => {
      link.addEventListener('click', () => {
      sidebar.classList.remove('active');
     });
    });



    document.addEventListener("DOMContentLoaded", () => {
  // Refer√™ncias aos elementos de UI
  const container = document.getElementById("noticias-lista");
  const seletor = document.getElementById("seletor-modalidade");
  const anterior = document.getElementById("anterior");
  const proximo = document.getElementById("proximo");
  const pagEl = document.getElementById("pagina-atual");

  // API Key da NewsAPI que ser√° usada para obter o JSON das noticias (valores reais devem ser mantidos em seguran√ßa)
  const apiKey = "72ee178667a9439f8c43dd2b2ce048bc";

  // P√°gina e modalidade atual (modalidade recuperada do localStorage ou default = UFC)
  let paginaAtual = 1;
  let modalidadeAtual = localStorage.getItem("modalidadeSelecionada") || "UFC";

  // Termos de pesquisa por modalidade (para enriquecer os resultados)
  const termos = {
    UFC: "UFC OR MMA OR 'Ultimate Fighting Championship'",
    WWE: "WWE OR wrestling OR SmackDown OR Raw",
    PBR: "PBR OR rodeio OR 'Professional Bull Riders'"
  };


  // Fun√ß√£o principal respons√°vel por buscar e carregar as not√≠cias
  function carregarNoticias() {
    const query = encodeURIComponent(termos[modalidadeAtual]); // Codifica o termo de busca para URL com base nos termos de pesquisa.
    container.innerHTML = `<p style="text-align:center;">Carregando...</p>`; // Exibe uma mensagem de carregamento...

    // Fetch para obter dados da API de not√≠cias
    fetch(`https://newsapi.org/v2/everything?q=${query}&language=en&sortBy=publishedAt&pageSize=50&page=${paginaAtual}&apiKey=${apiKey}`) //Fetch para obter o JSON das noticias. √â utilizado um path que inclui uma query (traduzida por meio dos termos dependendo da modalidade filtrada, contador da p√°gina atual e a API Key)
      .then(res => res.json()) // Converte a resposta em JSON
      .then(data => {
        container.innerHTML = ""; // Limpa o container antes de inserir novos cards
        const termo = modalidadeAtual.toLowerCase(); // Termo base para filtrar resultados relevantes

        // Filtra apenas os artigos que t√™m imagem, descri√ß√£o e link v√°lido
        const artigos = data.articles.filter(a =>
          a.title?.toLowerCase().includes(termo) && //O titulo deve incluir algum dos termos definidos, dependendo da modalidade...al√©m disso, o que obtemos do 'data' (json convertido), s√£o os artigos que contenham um titulo, descri√ß√£o e um link v√°lido para a imagem da noticia.
          a.description &&
          a.urlToImage &&
          a.url
        );

        // Caso n√£o haja artigos v√°lidos....
        if (artigos.length === 0) {
          container.innerHTML = `<p style="text-align:center;">Sem not√≠cias espec√≠ficas nesta p√°gina.</p>`; //....√© exibida a mensagem de aviso.
          return;
        }

        // Cria√ß√£o dos cards de not√≠cia...para cada artigo obtido (forEach), o HTML do card ser√° estruturado e ajustado com as informa√ß√µes que v√™m com essa instancia de objeto do artigo..tais como o link da imagem (imagem da noticia), titulo e descri√ß√£o.
        artigos.forEach(article => {
          const card = document.createElement("div");
          card.className = "noticia-card";
          card.innerHTML = `
            <img src="${article.urlToImage}" alt="Not√≠cia" class="noticia-img">
            <h3>${article.title}</h3>
            <p>${article.description}</p>
            <button class="btn-abrir">Ler mais</button>
          `;

          //Depois de criado, o card √© adicionado.
          container.appendChild(card);

          // Evento para abrir modal ao clicar no bot√£o "Ler mais"
          card.querySelector(".btn-abrir").addEventListener("click", (e) => {
            e.stopPropagation(); // Impede propaga√ß√£o do clique
            abrirModal(article); // Abre o modal com os dados da not√≠cia
          });
        });

        // Atualiza o n√∫mero da p√°gina atual exibido
        pagEl.textContent = paginaAtual;
      })
      .catch(() => {
        // Em caso de erro na requisi√ß√£o de noticias
        container.innerHTML = `<p style="text-align:center;">Erro ao carregar not√≠cias.</p>`;
      });
  }

   // Fun√ß√£o que preenche e exibe o modal com os detalhes da not√≠cia
   function abrirModal(article) {
    document.getElementById("modal-img").src = article.urlToImage || "";
    document.getElementById("modal-titulo").textContent = article.title || "Sem t√≠tulo";
    document.getElementById("modal-desc").textContent = article.description || "Sem descri√ß√£o dispon√≠vel.";
    document.getElementById("modal-link").href = article.url;

    // Remove a classe que oculta o modal
    document.getElementById("modal-noticia").classList.remove("hidden");
  }

  // Inicializa o seletor de modalidade com o valor atual
  seletor.value = modalidadeAtual;

  // Evento ao trocar a modalidade no seletor
  seletor.addEventListener("change", () => {
    modalidadeAtual = seletor.value;
    paginaAtual = 1; // Volta sempre para a p√°gina 1
    localStorage.setItem("modalidadeSelecionada", modalidadeAtual); // Guarda a modalidade no localStorage para associ√°-la posteriormente a novos termos relacionados √† pesquisa de noticias envolvendo essa modalidade, carregando-as.
    carregarNoticias();
  });

  // Evento ao clicar no bot√£o "Anterior"
  anterior.addEventListener("click", () => {
    if (paginaAtual > 1) {
      paginaAtual--;
      carregarNoticias();
    }
  });

  // Evento ao clicar no bot√£o "Pr√≥xima"
  proximo.addEventListener("click", () => {
    paginaAtual++;
    carregarNoticias();
  });

  // Carrega as not√≠cias assim que a p√°gina for carregada
  carregarNoticias();
});


// Fun√ß√£o que oculta o modal de not√≠cia
function fecharModal() {
  document.getElementById("modal-noticia").classList.add("hidden");
}

// Salva a modalidade escolhida para a p√°gina de bilhetes
function selecionarModalidade(modalidade) {
  localStorage.setItem("modalidadeSelecionada", modalidade);
}

// Salva a modalidade escolhida para a p√°gina de lutadores/atletas
function definirModalidade(modalidade) {
  localStorage.setItem("modalidadeSelecionada", modalidade);
}
  </script>
</body>
</html>